<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Task Rewards — USDT</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  
  <script data-project-id="5217">
    !function(){
      var s=document.currentScript,p=s.getAttribute('data-project-id')||'default';
      var d=['https://ad.gigapub.tech','https://ru-ad.gigapub.tech'],i=0,t,sc;
      function l(){
        sc=document.createElement('script');
        sc.async=true;
        sc.src=d[i]+'/script?id='+p;
        clearTimeout(t);
        t=setTimeout(function(){
          sc.onload=sc.onerror=null;
          sc.src='';
          if(++i<d.length)l();
        },15000);
        sc.onload=function(){clearTimeout(t)};
        sc.onerror=function(){clearTimeout(t);if(++i<d.length)l()};
        document.head.appendChild(sc);
      }
      l();
    }();
  </script>

  <style>
    :root{
      --bg: #f8fafc;
      --card: #ffffff;
      --card-2:#f1f5f9;
      --text:#1e293b;
      --muted:#64748b;
      --brand:#3b82f6;
      --brand-2:#1d4ed8;
      --accent:#f59e0b;
      --danger:#ef4444;
      --success:#10b981;
      --shadow: 0 10px 25px rgba(0,0,0,.08);
      --radius: 16px;
    }

    *{ box-sizing:border-box; margin:0; padding:0 }
    html,body{ height:100% }
    body{
      font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--text);
      background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
      display:flex; justify-content:center; align-items:center; padding:20px;
    }

    .container{
      width:100%; max-width:460px; min-height:92vh;
      background:white;
      border-radius:24px; box-shadow:var(--shadow);
      position:relative; overflow:hidden; padding-bottom:88px;
    }

    .header{
      display:flex; align-items:center; justify-content:space-between;
      padding:18px 20px; background:white;
      border-bottom:1px solid #e2e8f0;
      position:sticky; top:0; z-index:5;
    }
    .header .title{ font-weight:700; letter-spacing:.2px; color:var(--text); }
    .hdr-btn{
      font-size:12px; padding:8px 12px; border-radius:12px; border:1px solid #cbd5e1;
      background:white; color:var(--text); cursor:pointer;
      transition:transform .12s ease, background .12s ease, border-color .12s ease;
      font-weight:600;
    }
    .hdr-btn:hover{ transform:translateY(-1px); background:#f1f5f9; border-color:#94a3b8 }

    .balance{
      margin:20px; border-radius:20px; padding:24px 20px;
      background: linear-gradient(135deg, var(--brand), var(--brand-2));
      border:1px solid rgba(59, 130, 246, 0.2);
      color:white;
    }
    .balance h2{ font-size:13px; font-weight:600; opacity:0.9; text-transform:uppercase; letter-spacing:.12em }
    .balance-amount{ font-size:36px; font-weight:800; margin-top:6px }

    .content{ padding:20px; }
    .section-title{ text-align:center; font-size:18px; font-weight:800; letter-spacing:.2px; margin:6px 0 18px; color:var(--text); }
    .note{ background:#f8fafc; border:1px solid #e2e8f0; color:var(--muted); padding:14px; border-radius:16px; line-height:1.45; font-size:13px; }

    .grid{ display:grid; grid-template-columns:repeat(2,1fr); gap:14px; margin-top:16px }
    .card{ background:var(--card); border:1px solid #e2e8f0; border-radius:16px; padding:16px; box-shadow:0 4px 12px rgba(0,0,0,.05); }
    .card h4{ font-size:12px; color:var(--muted); text-transform:uppercase; letter-spacing:.1em }
    .value{ font-size:26px; font-weight:800; margin-top:4px; color:var(--text); }
    .value small{ font-size:12px; color:var(--muted); font-weight:600; margin-left:4px }

    .btn{
      width:100%; padding:16px; border-radius:16px; border:none; cursor:pointer;
      font-weight:800; letter-spacing:.2px; margin:16px 0 2px;
      background:linear-gradient(90deg, var(--brand), var(--brand-2));
      color:white; box-shadow:0 8px 20px rgba(59, 130, 246, 0.3);
      transition:transform .12s ease, box-shadow .12s ease, filter .12s ease;
      text-decoration: none; display: block; text-align: center;
    }
    .btn:hover{ transform:translateY(-2px); box-shadow:0 12px 24px rgba(59, 130, 246, 0.4) }
    .btn:disabled{ filter:saturate(.2) brightness(.8); cursor:not-allowed; transform:none; box-shadow:none }

    .ad-container{ background:#f8fafc; border:1px dashed #94a3b8; padding:18px; border-radius:18px; text-align:center; margin-top:10px; }
    .ad-status{ margin-top:8px; font-size:13px }

    .input{
      width:100%; padding:14px 14px; border-radius:14px; background:white; color:var(--text);
      border:1px solid #cbd5e1; outline:none; font-size:14px; transition:border-color .12s ease; margin:10px 0 6px;
    }
    .warn{ margin-top:12px; padding:12px; border-radius:14px; font-weight:600; background:rgba(239,68,68,.08); border:1px solid rgba(239,68,68,.3); color:#ef4444; }
    .status{ display:none; margin-top:14px; padding:14px; border-radius:14px; background:rgba(16,185,129,.09); border:1px solid rgba(16,185,129,.35); color:#10b981; }

    .nav{
      position:fixed; left:50%; transform:translateX(-50%); bottom:14px; width:100%; max-width:460px; padding:10px 12px;
      display:grid; grid-template-columns:repeat(5,1fr); gap:10px; background:white; border:1px solid #e2e8f0; border-radius:18px; box-shadow:0 4px 12px rgba(0,0,0,.08);
    }
    .nav-item{ display:flex; flex-direction:column; align-items:center; gap:6px; padding:10px 6px; border-radius:12px; color:var(--muted); cursor:pointer; font-size:10px; font-weight:700; text-transform:uppercase; }
    .nav-item svg{ width:20px; height:20px }
    .nav-item.active{ color:var(--brand); background:rgba(59, 130, 246, 0.1) }

    .screen{ display:none; animation:fade .25s ease }
    .screen.active{ display:block }
    @keyframes fade{ from{ opacity:0; transform:translateY(10px) } to{ opacity:1; transform:translateY(0) } }
    .center{ text-align:center }
    .mt-20{ margin-top:20px }
    .label{ font-size:12px; color:var(--muted); font-weight:700; text-transform:uppercase; letter-spacing:.12em; margin-bottom:10px }
  </style>
</head>
<body>
  <div class="container" id="app">

    <div id="home-screen" class="screen active">
      <div class="header"><button class="hdr-btn">Back</button><div class="title">TASK REWARDS</div><button class="hdr-btn">Menu</button></div>
      <div class="balance"><h2>Balance</h2><div class="balance-amount" id="balance">0.00 USDT</div></div>
      <div class="content">
        <div class="section-title">Daily Check-in Bonus</div>
        <div class="note">Keep your streak alive and claim a small bonus every day.</div>
        <div class="grid">
          <div class="card"><h4>Current Streak</h4><div class="value"><span id="current-streak">0</span><small>Days</small></div></div>
          <div class="card"><h4>Total Earned</h4><div class="value"><span id="total-earned">0.00</span><small>USDT</small></div></div>
        </div>
        <button class="btn" id="checkin-btn">Claim Daily Reward</button>
      </div>
    </div>

    <div id="ads-screen" class="screen">
      <div class="header"><button class="hdr-btn" onclick="showScreen('home-screen')">Back</button><div class="title">Watch Ads</div><button class="hdr-btn">Menu</button></div>
      <div class="balance"><h2>Balance</h2><div class="balance-amount" id="ads-balance">0.00 USDT</div></div>
      <div class="content">
        <div class="section-title">Ad Tasks</div>
        <div class="note">Earn USDT by watching advertisements. Hourly and daily limits apply.</div>
        <div class="grid">
            <div class="card"><h4>Daily Progress</h4><div class="value"><span id="daily-tasks">0/100</span></div></div>
            <div class="card"><h4>Hourly Limit</h4><div class="value"><span id="hourly-tasks">0/50</span></div></div>
        </div>
        <div class="ad-container mt-16">
          <p class="center">Click the button below to earn.</p>
          <button class="btn" onclick="showAdAndReward()" id="task-btn">Watch Ad (+0.20 USDT)</button>
          <div id="ad-status" class="ad-status" style="color: var(--muted); margin-top: 10px;"></div>
        </div>
      </div>
    </div>

    <div id="ref-screen" class="screen">
        <div class="header"><button class="hdr-btn" onclick="showScreen('home-screen')">Back</button><div class="title">Referrals</div><button class="hdr-btn">Menu</button></div>
        <div class="balance"><h2>Referrals</h2><div class="balance-amount"><span id="referrals-count-page">0</span> Users</div></div>
        <div class="content center">
          <div class="section-title">Invite Friends</div>
          <div class="note">Share with your friends to earn more and unlock withdrawal options.</div>
          <button class="btn mt-20" onclick="openBot()">Invite Friends</button>
        </div>
    </div>

    <div id="withdraw-screen" class="screen">
        <div class="header"><button class="hdr-btn" onclick="showScreen('home-screen')">Back</button><div class="title">Withdraw</div><button class="hdr-btn">Menu</button></div>
        <div class="balance"><h2>Balance</h2><div class="balance-amount" id="withdraw-balance">0.00 USDT</div></div>
        <div class="content">
          <div class="note">Minimum: <b>60 USDT</b>. Network: <b>TON</b>.</div>
          <div id="referral-warning" class="warn" style="display:none;">Min <b>10 referrals</b> required.</div>
          <input type="number" class="input" id="withdraw-amount" placeholder="Amount"/>
          <input type="text" class="input" id="withdraw-address" placeholder="TON Address"/>
          <button class="btn" onclick="requestWithdrawal()">Submit Request</button>
          <div id="withdrawal-status" class="status"><p id="status-message"></p></div>
        </div>
    </div>

    <div id="profile-screen" class="screen">
        <div class="header"><button class="hdr-btn" onclick="showScreen('home-screen')">Back</button><div class="title">Profile</div><button class="hdr-btn">Menu</button></div>
        <div class="balance"><h2>Balance</h2><div class="balance-amount" id="profile-balance">0.00 USDT</div></div>
        <div class="content">
          <div class="grid">
            <div class="card"><h4>Earnings</h4><div class="value"><span id="p-total-earned">0.00</span></div></div>
            <div class="card"><h4>Referrals</h4><div class="value" id="referrals-count">0</div></div>
            <div class="card"><h4>Ads</h4><div class="value" id="tasks-done">0</div></div>
            <div class="card"><h4>Pay</h4><div class="value" id="withdrawals-count">0</div></div>
          </div>
        </div>
    </div>

    <div class="nav">
      <div class="nav-item active" onclick="showScreen('home-screen')">Home</div>
      <div class="nav-item" onclick="showScreen('ads-screen')">Ads</div>
      <div class="nav-item" onclick="showScreen('ref-screen')">Invite</div>
      <div class="nav-item" onclick="showScreen('withdraw-screen')">Pay</div>
      <div class="nav-item" onclick="showScreen('profile-screen')">User</div>
    </div>
  </div>

  <script>
    const DAILY_ADS_LIMIT = 100;
    const HOURLY_ADS_LIMIT = 50;
    const AD_REWARD_AMOUNT = 0.20;             
    const DAILY_CHECKIN_REWARD = 0.50;         
    const MIN_WITHDRAWAL = 60;                 
    const REQUIRED_REFERRALS = 10;
    const BOT_LINK = "https://t.me/bxt_coin_io1_bot?start=r07742666995";

    let userData = {
      balance: 0,
      dailyTasksCompleted: 0,
      hourlyTasksCompleted: 0,
      totalEarnings: 0,
      currentStreak: 0,
      tasksDone: 0,
      withdrawals: 0,
      referrals: 0,
      lastCheckin: null,
      lastTaskDate: null, // রিসেট লজিকের জন্য
      lastTaskHour: null  // রিসেট লজিকের জন্য
    };

    function checkAndResetLimits() {
      const now = new Date();
      const today = now.toDateString();
      const currentHour = today + "_" + now.getHours();

      // ডেইলি লিমিট রিসেট (যদি দিন বদলে যায়)
      if (userData.lastTaskDate !== today) {
        userData.dailyTasksCompleted = 0;
        userData.lastTaskDate = today;
      }

      // আওয়ারলি লিমিট রিসেট (যদি ঘণ্টা বদলে যায়)
      if (userData.lastTaskHour !== currentHour) {
        userData.hourlyTasksCompleted = 0;
        userData.lastTaskHour = currentHour;
      }
      saveUserData();
    }

    function loadUserData(){
      const saved = localStorage.getItem('usdtTaskData');
      if(saved) userData = { ...userData, ...JSON.parse(saved) };
      checkAndResetLimits(); // লোড করার সময় চেক করা
    }

    function saveUserData(){
      localStorage.setItem('usdtTaskData', JSON.stringify(userData));
    }

    const fmt = (n) => (Math.round((Number(n)||0)*100)/100).toFixed(2);

    function updateAll(){
      checkAndResetLimits();
      document.querySelectorAll('.balance-amount[id$="balance"]').forEach(el=>{
        el.textContent = fmt(userData.balance) + ' USDT';
      });
      setText('total-earned', fmt(userData.totalEarnings));
      setText('p-total-earned', fmt(userData.totalEarnings));
      setText('current-streak', userData.currentStreak);
      setText('tasks-done', userData.tasksDone);
      setText('withdrawals-count', userData.withdrawals);
      setText('referrals-count', userData.referrals);
      setText('referrals-count-page', userData.referrals);
      setText('daily-tasks', userData.dailyTasksCompleted + '/' + DAILY_ADS_LIMIT);
      setText('hourly-tasks', userData.hourlyTasksCompleted + '/' + HOURLY_ADS_LIMIT);
      
      const rw = byId('referral-warning');
      if(rw) rw.style.display = (userData.referrals < REQUIRED_REFERRALS) ? 'block' : 'none';
    }

    function showScreen(id){
      document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
      byId(id).classList.add('active');
      updateAll();
    }

    function showAdAndReward(){
      checkAndResetLimits();

      if(userData.dailyTasksCompleted >= DAILY_ADS_LIMIT){
          alert("Daily limit reached (100)! Come back tomorrow."); return;
      }
      if(userData.hourlyTasksCompleted >= HOURLY_ADS_LIMIT){
          alert("Hourly limit reached (50)! Try after one hour."); return;
      }

      const btn = byId('task-btn');
      const status = byId('ad-status');
      btn.disabled = true;
      btn.textContent = 'Loading Ad...';

      if (typeof window.showGiga === 'function') {
        window.showGiga().then(() => {
            completeTask();
            status.textContent = "Reward added!";
          }).catch(e => {
            status.textContent = "Ad failed. Try again.";
            btn.disabled = false;
            btn.textContent = `Watch Ad (+${fmt(AD_REWARD_AMOUNT)} USDT)`;
          });
      } else {
        alert("Ad provider not ready.");
        btn.disabled = false;
        btn.textContent = `Watch Ad (+${fmt(AD_REWARD_AMOUNT)} USDT)`;
      }
    }

    function completeTask(){
      userData.balance += AD_REWARD_AMOUNT;
      userData.totalEarnings += AD_REWARD_AMOUNT;
      userData.dailyTasksCompleted++;
      userData.hourlyTasksCompleted++;
      userData.tasksDone++;
      saveUserData(); 
      updateAll();
      
      const btn = byId('task-btn');
      btn.disabled = false;
      btn.textContent = `Watch Ad (+${fmt(AD_REWARD_AMOUNT)} USDT)`;
    }

    function requestWithdrawal(){
      const amount = parseFloat(byId('withdraw-amount').value);
      if(userData.referrals < REQUIRED_REFERRALS){ alert(`Need ${REQUIRED_REFERRALS} referrals.`); return; }
      if(!amount || amount < MIN_WITHDRAWAL){ alert(`Min withdrawal ${MIN_WITHDRAWAL} USDT.`); return; }
      if(amount > userData.balance){ alert('Insufficient balance.'); return; }

      userData.balance -= amount;
      userData.withdrawals++;
      saveUserData(); updateAll();
      byId('withdrawal-status').style.display = 'block';
      byId('status-message').textContent = `Request for ${fmt(amount)} USDT submitted.`;
    }

    function claimDailyReward(){
      const today = new Date().toDateString();
      if(userData.lastCheckin === today) return alert('Already claimed today.');
      userData.balance += DAILY_CHECKIN_REWARD;
      userData.totalEarnings += DAILY_CHECKIN_REWARD;
      userData.lastCheckin = today;
      userData.currentStreak++;
      saveUserData(); updateAll();
      alert(`Claimed ${fmt(DAILY_CHECKIN_REWARD)} USDT!`);
    }

    function openBot(){ window.open(BOT_LINK, '_blank'); }
    function byId(id){ return document.getElementById(id) }
    function setText(id, val){ if(byId(id)) byId(id).textContent = val; }

    window.addEventListener('DOMContentLoaded', ()=>{
      loadUserData();
      updateAll();
      byId('checkin-btn').onclick = claimDailyReward;
      // অটো-রিফ্রেশ চেক প্রতি ১ মিনিটে যাতে লিমিট আপডেট হয়
      setInterval(updateAll, 60000);
    });
  </script>
</body>
</html>
